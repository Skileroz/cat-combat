<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Cat Combat</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin-top: 50px; }
    button { font-size: 18px; padding: 10px 20px; margin: 5px; cursor: pointer; }
    #upgrades button { display: block; margin: 10px auto; width: 250px; height: 60px; font-size: 16px; }
    button:disabled { background-color: #ccc; cursor: not-allowed; }
  </style>
</head>
<body>
  <h1>üò∫ Cat Combat</h1>
  <p>–ú–æ–Ω–µ—Ç—ã: <span id="coins">0</span></p>
  <button onclick="clickCat()">–ö–õ–ò–ö üêæ</button>

  <h2>–£–ª—É—á—à–µ–Ω–∏—è</h2>
  <div id="upgrades">
    <button id="btnClaws" onclick="buyUpgrade('claws')">–ö–æ–≥—Ç–∏ (+1 –∫–ª–∏–∫) ‚Äî 10 –º–æ–Ω–µ—Ç</button>
    <button onclick="buyUpgrade('toy')">–ò–≥—Ä—É—à–∫–∞ (+2 –∫–ª–∏–∫) ‚Äî 50 –º–æ–Ω–µ—Ç</button>
    <button onclick="buyUpgrade('mischief')">–ü–∞–∫–æ—Å—Ç—å (+5 –∫–ª–∏–∫) ‚Äî 200 –º–æ–Ω–µ—Ç</button>
    <button id="btnGuardDog" onclick="buyUpgrade('guardDog')">üê∂ –°—Ç–æ—Ä–æ–∂ –ë–æ–±–∏–∫ (–ø–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ +1/—Å–µ–∫) ‚Äî 100 –º–æ–Ω–µ—Ç</button>
  </div>

  <script>
    const tg = window.Telegram.WebApp;
    tg.ready();

    let coins = Number(localStorage.getItem("coins") || 0);
    let upgrades = JSON.parse(localStorage.getItem("upgrades") || '{"claws":0,"toy":0,"mischief":0,"guardDog":0}');

    const upgradeCosts = { claws: 10, toy: 50, mischief: 200, guardDog: 100 };
    const upgradePower = { claws: 1, toy: 2, mischief: 5, guardDog: 1 };
    const upgradeMax = { claws: 5, toy: 5, mischief: 5, guardDog: 5 };

    const coinDisplay = document.getElementById("coins");
    const btnClaws = document.getElementById("btnClaws");
    const btnGuardDog = document.getElementById("btnGuardDog");

    coinDisplay.innerText = coins;

    function clickCat() {
      let totalPower = 1 + upgrades.claws * upgradePower.claws +
                          upgrades.toy * upgradePower.toy +
                          upgrades.mischief * upgradePower.mischief;
      coins += totalPower;
      coinDisplay.innerText = coins;
      saveData();
    }

    function buyUpgrade(name) {
      if (upgrades[name] >= upgradeMax[name]) {
        alert("–£–ª—É—á—à–µ–Ω–∏–µ —É–∂–µ –ø—Ä–æ–∫–∞—á–∞–Ω–æ –¥–æ –º–∞–∫—Å–∏–º—É–º–∞!");
        disableButton(name);
        return;
      }

      let cost = upgradeCosts[name];
      if (coins >= cost) {
        coins -= cost;
        upgrades[name]++;
        coinDisplay.innerText = coins;
        saveData();

        if (upgrades[name] >= upgradeMax[name]) disableButton(name);

        if (name === 'guardDog') {
          alert(
            "–í—ã –∫—É–ø–∏–ª–∏ –ø–∏—Ç–æ–º—Ü–∞ üê∂ –°—Ç–æ—Ä–æ–∂ –ë–æ–±–∏–∫!\n\n" +
            "–û —Å–µ–±–µ: –Ω–µ–ø–ª–æ—Ö–æ–π –¥—Ä—É–≥, –Ω–æ –µ—Å–ª–∏ –ø—Ä–æ–ª–µ–∑—Ç—å —á–µ—Ä–µ–∑ –∑–∞–±–æ—Ä ‚Äî —Ç–∞–±–ª–∏—á–∫–∞ ¬´–û—Å—Ç–æ—Ä–æ–∂–Ω–æ, –∑–ª–∞—è —Å–æ–±–∞–∫–∞¬ª –æ–ø—Ä–∞–≤–¥–∞–µ—Ç –æ–∂–∏–¥–∞–Ω–∏–µ."
          );
        } else {
          alert(`–í—ã –∫—É–ø–∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏–µ: ${name}!`);
        }
      } else {
        alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!");
      }
    }

    function disableButton(name) {
      if (name === 'claws') btnClaws.disabled = true;
      if (name === 'guardDog') btnGuardDog.disabled = true;
    }

    function saveData() {
      localStorage.setItem("coins", coins);
      localStorage.setItem("upgrades", JSON.stringify(upgrades));
    }

    // –ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ –∫–∞–∂–¥—ã–µ 1 —Å–µ–∫—É–Ω–¥—É
    setInterval(() => {
      let passive = upgrades.guardDog * upgradePower.guardDog;
      if (passive > 0) {
        coins += passive;
        coinDisplay.innerText = coins;
        saveData();
      }
    }, 1000);

    // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ, –µ—Å–ª–∏ –∞–ø–≥—Ä–µ–π–¥ —É–∂–µ –º–∞–∫—Å
    if (upgrades.claws >= upgradeMax.claws) btnClaws.disabled = true;
    if (upgrades.guardDog >= upgradeMax.guardDog) btnGuardDog.disabled = true;
  </script>
</body>
</html>
