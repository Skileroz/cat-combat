<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Cat Combat - –ü–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è</title>
  <style>
    body { font-family: Arial; margin: 0; padding: 0; text-align: center; }
    #container { display: flex; justify-content: center; align-items: flex-start; gap: 50px; margin-top: 20px; }
    .upgradeColumn { display: flex; flex-direction: column; gap: 10px; min-width: 200px; }
    #centerColumn { display: flex; flex-direction: column; align-items: center; gap: 10px; min-width: 250px; }
    button { padding: 10px 20px; font-size: 18px; cursor: pointer; text-align: left; }
    button:disabled { background-color: #ccc; cursor: not-allowed; }
    #message { background: #fffa; padding: 10px; border-radius: 5px; display: none; max-width: 300px; margin-top: 10px; }
    #miniGame { display: none; position: relative; width: 300px; height: 300px; border:1px solid #000; margin-top: 10px; }
  </style>
</head>
<body>
  <h1>üò∫ Cat Combat - –ü–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è</h1>

  <div id="container">

    <!-- –°—Ç–æ–ª–±–∏–∫ 1: –ó–∞–¥–∞–Ω–∏—è -->
    <div class="upgradeColumn" id="missions">
      <h2>–ó–∞–¥–∞–Ω–∏—è</h2>
      <button onclick="completeMission('click50')">50 –∫–ª–∏–∫–æ–≤ –∑–∞ 1 –º–∏–Ω—É—Ç—É</button>
      <button onclick="completeMission('buyPet')">–ö—É–ø–∏—Ç—å –ø–∏—Ç–æ–º—Ü–∞</button>
      <button onclick="completeMission('upgradeMax')">–ü—Ä–æ–∫–∞—á–∞—Ç—å –∞–ø–≥—Ä–µ–π–¥ –¥–æ –º–∞–∫—Å</button>
    </div>

    <!-- –°—Ç–æ–ª–±–∏–∫ 2: –ê–ø–≥—Ä–µ–π–¥—ã -->
    <div class="upgradeColumn" id="basicUpgrades">
      <h2>–£–ª—É—á—à–µ–Ω–∏—è</h2>
      <button id="btnClaws" onclick="buyUpgrade('claws')">üó° –ö–æ–≥—Ç–∏ (+1 –∫–ª–∏–∫)</button>
      <button id="btnToy" onclick="buyUpgrade('toy')">üéæ –ò–≥—Ä—É—à–∫–∞ (+2 –∫–ª–∏–∫)</button>
      <button id="btnMischief" onclick="buyUpgrade('mischief')">üòà –ü–∞–∫–æ—Å—Ç—å (+5 –∫–ª–∏–∫)</button>
    </div>

    <!-- –°—Ç–æ–ª–±–∏–∫ 3: –¶–µ–Ω—Ç—Ä -->
    <div id="centerColumn">
      <p>–ú–æ–Ω–µ—Ç—ã: <span id="coins">0</span></p>
      <p>–≠–Ω–µ—Ä–≥–∏—è: <span id="energy">20</span>/20</p>
      <button onclick="clickCat()">–ö–õ–ò–ö üêæ</button>
      <div id="message"></div>
      <div id="passive">–ó–∞—Ä–∞–±–æ—Ç–æ–∫ –≤ —Å–µ–∫—É–Ω–¥—É: <span id="pps">0</span></div>
      <button onclick="startMiniGame()">üéÆ –ú–∏–Ω–∏-–∏–≥—Ä–∞</button>
      <div id="miniGame"></div>
    </div>

    <!-- –°—Ç–æ–ª–±–∏–∫ 4: –ü–∏—Ç–æ–º—Ü—ã -->
    <div class="upgradeColumn" id="petsSection">
      <h2>–ü–∏—Ç–æ–º—Ü—ã</h2>
      <button id="btnGuardDog" onclick="buyUpgrade('guardDog')">üê∂ –°—Ç–æ—Ä–æ–∂ –ë–æ–±–∏–∫ (+1/—Å–µ–∫)</button>
      <button id="btnCatPet" onclick="buyUpgrade('catPet')">üê± –ú—É—Ä–∫–∞ (+2/—Å–µ–∫)</button>
      <button id="btnHuskyPet" onclick="buyUpgrade('huskyPet')">üêï –•–∞—Å–∫–∏ (+3/—Å–µ–∫)</button>
    </div>

  </div>

<script>
// ======== –î–∞–Ω–Ω—ã–µ ========
let coins = Number(localStorage.getItem("coins") || 0);
let upgrades = JSON.parse(localStorage.getItem("upgrades") || '{"claws":0,"toy":0,"mischief":0,"guardDog":0,"catPet":0,"huskyPet":0}');
let clickMultiplier = 1;
let passiveBonus = 0;
let nextClickBonus = 0;
let maxEnergy = 20;
let energy = maxEnergy;

const coinDisplay = document.getElementById("coins");
const energyDisplay = document.getElementById("energy");
const ppsDisplay = document.getElementById("pps");
const message = document.getElementById("message");

const upgradeBaseCost = { claws:10, toy:50, mischief:200, guardDog:100, catPet:250, huskyPet:500 };
const upgradePower = { claws:1, toy:2, mischief:5, guardDog:1, catPet:2, huskyPet:3 };
const upgradeMax = { claws:5, toy:5, mischief:5, guardDog:5, catPet:5, huskyPet:5 };

coinDisplay.innerText = coins;
energyDisplay.innerText = energy;

// ======== –§—É–Ω–∫—Ü–∏–∏ ========
function getUpgradeCost(name){
  return Math.floor(upgradeBaseCost[name]*Math.pow(2,upgrades[name]));
}

function clickCat(){
  if(energy <= 0){
    showMessage("‚ö° –ù–µ—Ç —ç–Ω–µ—Ä–≥–∏–∏ –¥–ª—è –∫–ª–∏–∫–∞!");
    return;
  }
  let totalPower = (1 + upgrades.claws*upgradePower.claws + upgrades.toy*upgradePower.toy + upgrades.mischief*upgradePower.mischief)*clickMultiplier + nextClickBonus;
  coins += totalPower;
  nextClickBonus = 0;
  energy--;
  coinDisplay.innerText = coins;
  energyDisplay.innerText = energy;
  saveData();
}

function buyUpgrade(name){
  if(upgrades[name]>=upgradeMax[name]){
    showMessage("‚úÖ –ú–∞–∫—Å–∏–º—É–º –¥–æ—Å—Ç–∏–≥–Ω—É—Ç");
    disableButton(name);
    return;
  }
  let cost = getUpgradeCost(name);
  if(coins>=cost){
    coins-=cost;
    upgrades[name]++;
    coinDisplay.innerText = coins;
    saveData();
    showMessage(`${getUpgradeName(name)} –∫—É–ø–ª–µ–Ω–æ!`);
    if(upgrades[name]>=upgradeMax[name]) disableButton(name);
    updatePPS();
  } else showMessage("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!");
}

function getUpgradeName(name){
  switch(name){
    case 'claws': return 'üó° –ö–æ–≥—Ç–∏';
    case 'toy': return 'üéæ –ò–≥—Ä—É—à–∫–∞';
    case 'mischief': return 'üòà –ü–∞–∫–æ—Å—Ç—å';
    case 'guardDog': return 'üê∂ –°—Ç–æ—Ä–æ–∂ –ë–æ–±–∏–∫';
    case 'catPet': return 'üê± –ú—É—Ä–∫–∞';
    case 'huskyPet': return 'üêï –•–∞—Å–∫–∏';
    default: return name;
  }
}

function disableButton(name){
  const btnMap = { claws:btnClaws, toy:btnToy, mischief:btnMischief, guardDog:btnGuardDog, catPet:btnCatPet, huskyPet:btnHuskyPet};
  if(upgrades[name]>=upgradeMax[name]){
    btnMap[name].disabled=true;
    btnMap[name].innerText = getUpgradeName(name) + " ‚Äî –ö—É–ø–ª–µ–Ω–æ";
  }
}

function saveData(){
  localStorage.setItem("coins",coins);
  localStorage.setItem("upgrades",JSON.stringify(upgrades));
}

function showMessage(text){
  message.innerText=text;
  message.style.display="block";
  setTimeout(()=>message.style.display="none",4000);
}

function updatePPS(){
  let pps = upgrades.guardDog*upgradePower.guardDog + upgrades.catPet*upgradePower.catPet + upgrades.huskyPet*upgradePower.huskyPet + passiveBonus;
  ppsDisplay.innerText = pps;
}

// ======== –ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ ========
setInterval(()=>{
  let passive = upgrades.guardDog*upgradePower.guardDog + upgrades.catPet*upgradePower.catPet + upgrades.huskyPet*upgradePower.huskyPet + passiveBonus;
  coins+=passive;
  coinDisplay.innerText=coins;
  saveData();
  updatePPS();
},1000);

// ======== –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ ========
setInterval(()=>{
  if(energy<maxEnergy){ energy++; energyDisplay.innerText=energy; }
},1000);

// ======== –°–ª—É—á–∞–π–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è ========
setInterval(()=>{
  if(Math.random()<0.4) randomEvent();
},30000);

function randomEvent(){
  const events = [
    {text:"üê≠ –ö–æ—Ç—ë–Ω–æ–∫ –Ω–∞—à—ë–ª –º–æ–Ω–µ—Ç—ã +50", action:()=>coins+=50},
    {text:"‚ö° –í—Å–ø–ª–µ—Å–∫ —ç–Ω–µ—Ä–≥–∏–∏! –ö–ª–∏–∫–∏ √ó2 –Ω–∞ 10 —Å–µ–∫—É–Ω–¥", action:()=>{
      clickMultiplier=2; setTimeout(()=>clickMultiplier=1,10000);
    }},
    {text:"üéâ –ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ √ó2 –Ω–∞ 15 —Å–µ–∫—É–Ω–¥", action:()=>{
      passiveBonus = upgrades.guardDog+upgrades.catPet+upgrades.huskyPet;
      setTimeout(()=>passiveBonus=0,15000);
    }},
    {text:"üíé –î—Ä–∞–≥–æ—Ü–µ–Ω–Ω—ã–π –∫–∞–º–µ–Ω—å +200", action:()=>coins+=200},
    {text:"üî• –°–ª–µ–¥—É—é—â–∏–π –∫–ª–∏–∫ +50 –º–æ–Ω–µ—Ç", action:()=>nextClickBonus=50}
  ];
  const e = events[Math.floor(Math.random()*events.length)];
  e.action();
  showMessage(e.text);
}

// ======== –ú–∏–Ω–∏-–∏–≥—Ä–∞ ========
function startMiniGame(){
  let miniCoins = 0;
  const game = document.getElementById("miniGame");
  game.innerHTML=""; game.style.display="block";
  const mouse=document.createElement("div");
  mouse.innerText="üê≠"; mouse.style.position="absolute"; mouse.style.fontSize="24px";
  game.appendChild(mouse);

  function moveMouse(){ mouse.style.top=Math.random()*260+"px"; mouse.style.left=Math.random()*260+"px"; }
  moveMouse();

  mouse.onclick=()=>{ miniCoins+=10; moveMouse(); }

  setTimeout(()=>{
    game.style.display="none";
    coins+=miniCoins; coinDisplay.innerText=coins; saveData();
    showMessage(`üéâ –ú–∏–Ω–∏-–∏–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! +${miniCoins} –º–æ–Ω–µ—Ç`);
  },10000);
}

// ======== –ú–∏—Å—Å–∏–∏/–∑–∞–¥–∞–Ω–∏—è ========
function completeMission(name){
  switch(name){
    case 'click50':
      showMessage("–ó–∞–¥–∞–Ω–∏–µ: –°–¥–µ–ª–∞–π 50 –∫–ª–∏–∫–æ–≤ ‚Äî +100 –º–æ–Ω–µ—Ç");
      coins += 100; coinDisplay.innerText = coins;
      break;
    case 'buyPet':
      showMessage("–ó–∞–¥–∞–Ω–∏–µ: –ö—É–ø–∏ –ø–∏—Ç–æ–º—Ü–∞ ‚Äî +200 –º–æ–Ω–µ—Ç");
      coins += 200; coinDisplay.innerText = coins;
      break;
    case 'upgradeMax':
      showMessage("–ó–∞–¥–∞–Ω–∏–µ: –ü—Ä–æ–∫–∞—á–∞–π –∞–ø–≥—Ä–µ–π–¥ –¥–æ –º–∞–∫—Å ‚Äî +300 –º–æ–Ω–µ—Ç");
      coins += 300; coinDisplay.innerText = coins;
      break;
  }
  saveData();
}

// ======== –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫ –ø—Ä–∏ –º–∞–∫—Å–∏–º—É–º–µ ========
['claws','toy','mischief','guardDog','catPet','huskyPet'].forEach(disableButton);
updatePPS();
</script>
</body>
</html>


