<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Cat Combat</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin-top: 50px; }
    button { font-size: 18px; padding: 10px 20px; margin: 5px; cursor: pointer; }
    #upgrades button { display: block; margin: 10px auto; width: 280px; height: 60px; font-size: 16px; }
    button:disabled { background-color: #ccc; cursor: not-allowed; }
    #message { position: fixed; top: 10px; right: 10px; background: #fffa; padding: 10px; border: 1px solid #333; border-radius: 5px; display: none; max-width: 300px; }
    #passive { margin-top: 10px; font-weight: bold; }
  </style>
</head>
<body>
  <h1>üò∫ Cat Combat</h1>
  <p>–ú–æ–Ω–µ—Ç—ã: <span id="coins">0</span></p>
  <button onclick="clickCat()">–ö–õ–ò–ö üêæ</button>

  <h2>–£–ª—É—á—à–µ–Ω–∏—è</h2>
  <div id="upgrades">
    <button id="btnClaws" onclick="buyUpgrade('claws')">–ö–æ–≥—Ç–∏ (+1 –∫–ª–∏–∫) ‚Äî 10 –º–æ–Ω–µ—Ç</button>
    <button onclick="buyUpgrade('toy')">–ò–≥—Ä—É—à–∫–∞ (+2 –∫–ª–∏–∫) ‚Äî 50 –º–æ–Ω–µ—Ç</button>
    <button onclick="buyUpgrade('mischief')">–ü–∞–∫–æ—Å—Ç—å (+5 –∫–ª–∏–∫) ‚Äî 200 –º–æ–Ω–µ—Ç</button>
    <button id="btnGuardDog" onclick="buyUpgrade('guardDog')">üê∂ –°—Ç–æ—Ä–æ–∂ –ë–æ–±–∏–∫ (–ø–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ +1/—Å–µ–∫) ‚Äî 100 –º–æ–Ω–µ—Ç</button>
    <button id="btnCatPet" onclick="buyUpgrade('catPet')">üê± –ú—É—Ä–∫–∞ (–ø–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ +2/—Å–µ–∫) ‚Äî 250 –º–æ–Ω–µ—Ç</button>
    <button id="btnHuskyPet" onclick="buyUpgrade('huskyPet')">üêï –•–∞—Å–∫–∏ (–ø–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ +3/—Å–µ–∫) ‚Äî 500 –º–æ–Ω–µ—Ç</button>
  </div>

  <div id="passive">–ó–∞—Ä–∞–±–æ—Ç–æ–∫ –≤ —Å–µ–∫—É–Ω–¥—É: <span id="pps">0</span></div>
  <div id="message"></div>

  <script>
    const tg = window.Telegram.WebApp;
    tg.ready();

    let coins = Number(localStorage.getItem("coins") || 0);
    let upgrades = JSON.parse(localStorage.getItem("upgrades") || '{"claws":0,"toy":0,"mischief":0,"guardDog":0,"catPet":0,"huskyPet":0}');

    const upgradeCosts = { claws: 10, toy: 50, mischief: 200, guardDog: 100, catPet: 250, huskyPet: 500 };
    const upgradePower = { claws: 1, toy: 2, mischief: 5, guardDog: 1, catPet: 2, huskyPet: 3 };
    const upgradeMax = { claws: 5, toy: 5, mischief: 5, guardDog: 5, catPet: 5, huskyPet: 5 };

    const coinDisplay = document.getElementById("coins");
    const btnClaws = document.getElementById("btnClaws");
    const btnGuardDog = document.getElementById("btnGuardDog");
    const btnCatPet = document.getElementById("btnCatPet");
    const btnHuskyPet = document.getElementById("btnHuskyPet");
    const message = document.getElementById("message");
    const ppsDisplay = document.getElementById("pps");

    coinDisplay.innerText = coins;

    function clickCat() {
      let totalPower = 1 + upgrades.claws * upgradePower.claws +
                          upgrades.toy * upgradePower.toy +
                          upgrades.mischief * upgradePower.mischief;
      coins += totalPower;
      coinDisplay.innerText = coins;
      saveData();
    }

    function buyUpgrade(name) {
      if (upgrades[name] >= upgradeMax[name]) {
        showMessage(`${getUpgradeName(name)} —É–∂–µ –ø—Ä–æ–∫–∞—á–∞–Ω–æ!`);
        disableButton(name);
        return;
      }

      let cost = upgradeCosts[name];
      if (coins >= cost) {
        coins -= cost;
        upgrades[name]++;
        coinDisplay.innerText = coins;
        saveData();

        if (upgrades[name] >= upgradeMax[name]) disableButton(name);

        if (name === 'guardDog') {
          showMessage(`üê∂ –°—Ç–æ—Ä–æ–∂ –ë–æ–±–∏–∫ –∫—É–ø–ª–µ–Ω! –û —Å–µ–±–µ: –Ω–µ–ø–ª–æ—Ö–æ–π –¥—Ä—É–≥, –Ω–æ –µ—Å–ª–∏ –ø—Ä–æ–ª–µ–∑—Ç—å —á–µ—Ä–µ–∑ –∑–∞–±–æ—Ä ‚Äî —Ç–∞–±–ª–∏—á–∫–∞ ¬´–û—Å—Ç–æ—Ä–æ–∂–Ω–æ, –∑–ª–∞—è —Å–æ–±–∞–∫–∞¬ª –æ–ø—Ä–∞–≤–¥–∞–µ—Ç –æ–∂–∏–¥–∞–Ω–∏–µ.`);
        } else if (name === 'catPet') {
          showMessage(`üê± –ú—É—Ä–∫–∞ –∫—É–ø–ª–µ–Ω–∞! –õ—é–±–∏—Ç –º—É—Ä–ª—ã–∫–∞—Ç—å –∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –ø–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥.`);
        } else if (name === 'huskyPet') {
          showMessage(`üêï –•–∞—Å–∫–∏ –∫—É–ø–ª–µ–Ω! –°–∏–ª—å–Ω—ã–π –ø–∏—Ç–æ–º–µ—Ü, –¥–∞—ë—Ç –±–æ–ª—å—à–µ –ø–∞—Å—Å–∏–≤–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞.`);
        } else {
          showMessage(`${getUpgradeName(name)} –∫—É–ø–ª–µ–Ω–æ!`);
        }

        updatePPS();
      } else {
        showMessage("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!");
      }
    }

    function getUpgradeName(name) {
      switch(name) {
        case 'claws': return '–ö–æ–≥—Ç–∏';
        case 'toy': return '–ò–≥—Ä—É—à–∫–∞';
        case 'mischief': return '–ü–∞–∫–æ—Å—Ç—å';
        case 'guardDog': return '–°—Ç–æ—Ä–æ–∂ –ë–æ–±–∏–∫';
        case 'catPet': return '–ú—É—Ä–∫–∞';
        case 'huskyPet': return '–•–∞—Å–∫–∏';
        default: return name;
      }
    }

    function disableButton(name) {
      const btnMap = {
        claws: btnClaws,
        guardDog: btnGuardDog,
        catPet: btnCatPet,
        huskyPet: btnHuskyPet
      };
      if (btnMap[name]) {
        btnMap[name].disabled = true;
        btnMap[name].innerText = `${getUpgradeName(name)} ‚Äî –ö—É–ø–ª–µ–Ω–æ`;
      }
    }

    function saveData() {
      localStorage.setItem("coins", coins);
      localStorage.setItem("upgrades", JSON.stringify(upgrades));
    }

    function showMessage(text) {
      message.innerText = text;
      message.style.display = "block";
      setTimeout(() => message.style.display = "none", 4000);
    }

    function updatePPS() {
      let pps = upgrades.guardDog*upgradePower.guardDog + upgrades.catPet*upgradePower.catPet + upgrades.huskyPet*upgradePower.huskyPet;
      ppsDisplay.innerText = pps;
    }

    // –ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ –∫–∞–∂–¥—ã–µ 1 —Å–µ–∫—É–Ω–¥—É
    setInterval(() => {
      let passive = upgrades.guardDog*upgradePower.guardDog + upgrades.catPet*upgradePower.catPet + upgrades.huskyPet*upgradePower.huskyPet;
      if (passive > 0) {
        coins += passive;
        coinDisplay.innerText = coins;
        saveData();
        updatePPS();
      }
    }, 1000);

    // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ, –µ—Å–ª–∏ –∞–ø–≥—Ä–µ–π–¥ —É–∂–µ –º–∞–∫—Å
    if (upgrades.claws >= upgradeMax.claws) disableButton('claws');
    if (upgrades.guardDog >= upgradeMax.guardDog) disableButton('guardDog');
    if (upgrades.catPet >= upgradeMax.catPet) disableButton('catPet');
    if (upgrades.huskyPet >= upgradeMax.huskyPet) disableButton('huskyPet');

    updatePPS();
  </script>
</body>
</html>

